<div class="modal fade" id="add-layer-modal" tabindex="-1" aria-labelledby="add-layer-modal-label" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen-lg-down modal-xl">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="add-layer-modal-label">Ajouter une couche de données</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <!--<form id="login-form" class="login-validation" novalidate>-->
                <div class="modal-body">

                    <div class="row modal-content-with-menu">
                        <div class="col-lg-2 col-menu">
                            <div id="add-layer-menu" class="btn-group-vertical" role="group">
                                
                                <input type="radio" class="modal-btn-check btn-check" name="btnradio" id="btn-add-ref-layer" autocomplete="off" target="add-ref-layer" checked>
                                <label class="btn btn-outline-primary" for="btn-add-ref-layer">Couches de référence</label>

                                <input type="radio" class="modal-btn-check btn-check" name="btnradio" id="btn-add-obs-layer" autocomplete="off" target="add-obs-layer">
                                <label class="btn btn-outline-primary" for="btn-add-obs-layer">Données d'observation</label>
                                
                                <input type="radio" class="modal-btn-check btn-check" name="btnradio" id="btn-add-imported-layer" autocomplete="off" target="add-imported-layer">
                                <label class="btn btn-outline-primary" for="btn-add-imported-layer">Import de données</label>

                                <input type="radio" class="modal-btn-check btn-check" name="btnradio" id="btn-add-drawing-layer" autocomplete="off" target="add-drawing-layer">
                                <label class="btn btn-outline-primary" for="btn-add-drawing-layer">Couches de dessin</label>
                                
                                {#
                                <input type="radio" class="modal-btn-check btn-check" name="btnradio" id="btn-add-my-layer" autocomplete="off" target="add-my-layer">
                                <label class="btn btn-outline-primary" for="btn-add-my-layer">Mes couches</label>
                                #}
                                {#
                                <input type="radio" class="modal-btn-check btn-check" name="btnradio" id="btn-add-shared-layer" autocomplete="off" target="add-shared-layer">
                                <label class="btn btn-outline-primary" for="btn-add-shared-layer">Couches partagées</label>
                                #}
                                {#
                                <input type="radio" class="modal-btn-check btn-check" name="btnradio" id="btn-add-new-layer" autocomplete="off" target="add-new-layer">
                                <label class="btn btn-outline-primary" for="btn-add-new-layer">Création</label>
                                #}
                            </div>
                        </div>
                        <div class="col-lg-10 col-content">
                            <!-- content = Couche de référence -->
                            <div id="add-ref-layer" class="modal-div-content show">
                                <div class="accordion" id="accordion-add-ref-layer" data-prototype="
                                &lt;div class=&quot;accordion-item&quot;&gt; &lt;h2 class=&quot;accordion-header&quot; id=&quot;__ACCORDION_HEADER_ID__&quot;&gt; &lt;button class=&quot;accordion-button collapsed&quot; type=&quot;button&quot; data-bs-toggle=&quot;collapse&quot; data-bs-target=&quot;#__COLLAPSE_ID__&quot; aria-expanded=&quot;false&quot; aria-controls=&quot;collapseOne&quot;&gt; __GROUP_NAME__ &lt;/button&gt; &lt;/h2&gt; &lt;div id=&quot;__COLLAPSE_ID__&quot; class=&quot;accordion-collapse collapse&quot; aria-labelledby=&quot;__ACCORDION_HEADER_ID__&quot; data-bs-parent=&quot;#accordion-add-ref-layer&quot;&gt; &lt;div class=&quot;accordion-body&quot;&gt; &lt;ul class=&quot;modal-ref-layer-list&quot;&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;">                             
                                </div>
                            </div>


                            <!-- content = Données d'observation -->
                            <div id="add-obs-layer" class="modal-div-content">
                                <form id="form-add-obs-layer">
                                    <div class="row">
                                        <!-- Bloc de gauche -->
                                        <div class="col-lg-6 border-end">
                                            <div class="form-group">
                                                <div id="search-taxon-bloc">
                                                    <label class="form-label fw-bold mb-0 mt-2">Taxon :</label>
                                                    <div class="input-group">
                                                        <input type="text" class="form-control form-control-lg" id="search-taxon-input" placeholder="Rechercher un taxon">
                                                        <span  id="taxon-autocomplete-loading" class="input-group-text">
                                                            <span id="taxon-autocomplete-spinner" class="spinner-grow spinner-grow-sm"></span>
                                                        </span>
                                                    </div>
                                                
                                                    <div id="taxon-autocomplete"></div>

                                                    <ul id="selected-taxon"></ul>
                                                    
                                                    <!--<input type="hidden" id="form-add-obs-layer-taxon-value">-->
                                                </div>
                                                <div class="hide">
                                                    <input type="checkbox" id="form-add-obs-layer-infrataxon-checkbox"> 
                                                    <label for="form-add-obs-layer-infrataxon-checkbox">Inclure les infra-taxons</label>
                                                </div>
                                            </div>

                                            <div id="form-add-obs-layer-select-regne-bloc" class="form-group">
                                                <label for="form-add-obs-layer-select-regne" class="form-label fw-bold mb-0 mt-2">Règnes :</label>
                                                <span id="form-add-obs-layer-select-regne"></span>
                                                <input type="hidden" id="form-add-obs-layer-regne-value">
                                            </div>

                                            <div id="form-add-obs-layer-select-grp-tax-bloc" class="form-group">
                                                <label for="form-add-obs-layer-select-grp-tax" class="form-label fw-bold mb-0 mt-2">Groupe(s) taxonomique(s) :</label>
                                                <span id="form-add-obs-layer-select-grp-tax"></span>
                                                <input type="hidden" id="form-add-obs-layer-grp-tax-value">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label fw-bold mb-0 mt-2">Date d'observation :</label>
                                                <div class="row px-2">
                                                    <div class="col-lg-6">
                                                        <div class="form-group">
                                                            <label for="form-add-obs-layer-date-start" class="form-label">Date min :</label>
                                                            <input type="date" id="form-add-obs-layer-date-start" class="form-control form-control-lg">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <div class="form-group">
                                                            <label for="form-add-obs-layer-date-end" class="form-label">Date max :</label>
                                                            <input type="date" id="form-add-obs-layer-date-end" class="form-control form-control-lg">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label fw-bold mb-0 mt-2">Période d'observation :</label>
                                                <div class="row px-2">
                                                    <div class="col-lg-6">
                                                        <div class="form-group ">
                                                            <label for="form-add-obs-layer-periode-start" class="form-label">Début :</label>
                                                            <input type="text" id="form-add-obs-layer-periode-start" placeholder="jj/mm" class="form-control form-control-lg">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <div class="form-group">
                                                            <label for="form-add-obs-layer-periode-end" class="form-label">Fin :</label>
                                                            <input type="text" id="form-add-obs-layer-periode-end" placeholder="jj/mm" class="form-control form-control-lg">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="form-add-obs-layer-select-statut" class="form-label fw-bold mb-0 mt-2">Statut(s) :</label>
                                                <span id="form-add-obs-layer-select-statut"></span>
                                                <input type="hidden" id="form-add-obs-layer-statut-value">

                                                <div id="form-group-status-checkboxes">
                                                    <!--<div class="form-group">
                                                        <input type="checkbox" id="form-control form-add-obs-esp-prot-checkbox"> 
                                                        <label  
                                                            toggle-tooltip="tooltip" 
                                                            data-bs-placement="right" 
                                                            data-bs-trigger="hover" 
                                                            title="Protection nationale (art I / II / III) + Listes régionales + Listes départementales"
                                                            >
                                                            Espèces protégées
                                                        </label>
                                                    </div>

                                                    <div class="form-group">
                                                        <input type="checkbox" id="form-control form-add-obs-esp-men-checkbox"> 
                                                        <label 
                                                            toggle-tooltip="tooltip" 
                                                            data-bs-placement="right" 
                                                            data-bs-trigger="hover" 
                                                            title="Liste rouge (France et régionale) - catégorie 'CR', 'VU', 'EN'"
                                                            >
                                                            Espèces menacées
                                                        </label>
                                                    </div>

                                                    <div class="form-group">
                                                        <input type="checkbox" id="form-control form-add-obs-esp-quasi-men-checkbox"> 
                                                        <label 
                                                            toggle-tooltip="tooltip" 
                                                            data-bs-placement="right" 
                                                            data-bs-trigger="hover" 
                                                            title="Liste rouge (France et régionale) - catégorie 'NT'"
                                                            >
                                                            Espèces quasi-menacées
                                                        </label>
                                                    </div>

                                                    <div class="form-group">
                                                        <input type="checkbox" id="form-control form-add-obs-eee-checkbox"> 
                                                        <label 
                                                            toggle-tooltip="tooltip" 
                                                            data-bs-placement="right" 
                                                            data-bs-trigger="hover" 
                                                            title="Espèces exotiques envahissantes avérées, potentielles, emergentes et à surveiller"
                                                            >
                                                            Espèces envahissantes
                                                        </label>
                                                    </div>-->
                                                </div>
                                            </div>

                                            
                                        </div>
                                        <!-- Bloc de droite -->
                                        <div class="col-lg-6">
                                            <div class="form-group">
                                                <label for="form-add-obs-layer-select-commune" class="form-label fw-bold mb-0 mt-2">Commune(s) :</label>
                                                <span id="form-add-obs-layer-select-commune"></span>
                                                <input type="hidden" id="form-add-obs-layer-commune-value">
                                            </div>

                                            <div class="form-group">
                                                <label class="form-label fw-bold mb-0 mt-2">Altitude :</label>
                                                <div class="row px-2">
                                                    <div class="col-lg-6">
                                                        <div class="form-group">
                                                            <label for="form-add-obs-layer-alitude-min" class="form-label">min :</label>
                                                            <input type="text" id="form-add-obs-layer-altitude-min" class="form-control form-control-lg">
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <div class="form-group">
                                                            <label for="form-add-obs-layer-altitude-max" class="form-label">max :</label>
                                                            <input type="text" id="form-add-obs-layer-altitude-max" class="form-control form-control-lg">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label for="form-add-obs-layer-select-restitution" class="form-label fw-bold mb-0 mt-2">Type de restitution * :</label>
                                                <span id="form-add-obs-layer-select-restitution"></span>
                                                <input type="hidden" id="form-add-obs-layer-restitution-value" required>
                                            </div>

                                            <div class="form-group">
                                                <label for="form-add-obs-layer-select-scale" class="form-label fw-bold mb-0 mt-2">Echelle * :</label>
                                                <span id="form-add-obs-layer-select-scale"></span>
                                                <input type="hidden" id="form-add-obs-layer-scale-value" required>
                                                <div id="brut-data-warning" class="text-warning hide">
                                                    L'affichage des données brutes peut être long et rendre la navigation carto peu réactive.<br> <b>Pensez à configurer les filtres pour n'avoir que les données qui vous intéressent !</b>
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                </form>
                            </div>

                            <!-- content = Mes couches -->
                            <div id="add-my-layer" class="modal-div-content">Mes couches</div>


                            <!-- content = Couches partagées -->
                            <div id="add-shared-layer" class="modal-div-content">Couches partagées</div>


                            <!-- content = Création -->
                            <div id="add-new-layer" class="modal-div-content">Création</div>


                            <!-- content = Importer -->
                            <div id="add-imported-layer" class="modal-div-content">
                                <ul class="nav nav-tabs" id="import-layer-tab" role="import-list">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="upload-layer-tab" data-bs-toggle="tab" data-bs-target="#upload-layer" type="button" role="tab" aria-controls="upload-layer" aria-selected="true">Importer</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="my-uploaded-layers-tab" data-bs-toggle="tab" data-bs-target="#my-uploaded-layers" type="button" role="tab" aria-controls="my-uploaded-layer" aria-selected="false">Mes données importées</button>
                                    </li>
                                </ul>
                                <div class="tab-content" id="import-layer-tab-content">
                                    <!-- Panneau de mise en forme du formulaire d'upload de couche SIG -->
                                    <div class="tab-pane fade show active" id="upload-layer" role="tabpanel" aria-labelledby="upload-layer-tab">
                                        <form id="form-upload-layer" enctype="multipart/form-data">
                                            <div class="row mt-3 mb-2">
                                                <div class="col-12 p-2 border">
                                                    <p class="m-0 text-warning"><b>Attention !</b> Selon la taille du fichier importé, le temps de traitement peut prendre <b>plusieurs minutes</b></p>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <!-- Bloc de gauche -->
                                                <div class="col-lg-6 border-end">
                                                    <!-- Champ format de fichier-->
                                                    <div class="form-group">
                                                        <label for="form-upload-layer-select-format" class="form-label fw-bold mb-0 mt-2">Format du fichier * :</label>
                                                        <select id="form-upload-layer-select-format" class="form-select" aria-label="Default select example">
                                                            <option selected></option>
                                                            <option value="geojson">GeoJson</option>
                                                            <option value="gpkg">GeoPackage</option>
                                                            <option value="gpx">GPX</option>
                                                            <option value="kmz">KML / KMZ</option>
                                                            <option value="tab">Mapinfo (TAB)</option>
                                                            <option value="shp">Shapefile</option>
                                                        </select>
                                                        <div id="upload-layer-format-shp-warning" class="text-warning hide">
                                                            L'import d'un shapefile doit inclure à minima les fichiers ayant les extensions suivantes : <b>.shp, .prj, .dbf, .shx</b>
                                                        </div>
                                                        <div id="upload-layer-format-tab-warning" class="text-warning hide">
                                                            L'import d'un fichier mapinfo (TAB) doit inclure à minima les fichiers ayant les extensions suivantes : <b>.tab, .dat, .id, .map</b>
                                                        </div>
                                                    </div>

                                                    <!-- Champ nom de la données -->
                                                    <div class="form-group">
                                                        <label for="form-upload-layer-data-name" class="form-label fw-bold mb-0 mt-2">Nom de la couche de donnée *</label>
                                                        <input type="text" class="form-control" id="form-upload-layer-data-name" placeholder="Nom">
                                                    </div>

                                                    
                                                </div>
                                                <!-- Bloc de droite -->
                                                <div class="col-lg-6">
                                                    
                                                    <!-- Sélection des fichiers -->
                                                    <div class="col-lg-6">
                                                        <div class="form-group">
                                                            <label for="form-upload-layer-files" class="form-label fw-bold mb-0 mt-2">Fichier(s) * :</label><br>
                                                            <input type="file" id="form-upload-layer-files" class="hide" multiple>
                                                            <button id="form-upload-layer-files-btn" type="button" class="btn btn-primary">Parcourir...</button>
                                                            <ul id="form-upload-layer-file-list" class="form-upload-layer-file-list">
                                                            </ul>
                                                        </div>
                                                    </div>
                                                    
                                                    <!-- Sélection de la projection - INUTILE !! -->
                                                    <!--<div class="form-group">
                                                        <label for="form-upload-layer-select-proj" class="form-label fw-bold mb-0 mt-2">Projection du fichier * :</label>
                                                        <select id="form-upload-layer-select-proj" class="form-select" aria-label="Default select example">
                                                            <option value="EPSG:2154" selected>Lambert-93 (EPSG:2154)</option>
                                                            <option value="EPSG:4326">WGS 84 (EPSG:4326)</option>
                                                            <option value="EPSG:3857">WGS 84 / Pseudo-Mercator (EPSG:3857)</option>
                                                        </select>
                                                    </div>-->
                                                </div>
                                            </div>
                                        </form>

                                    </div>
                                    <!-- Panneau affichant la liste des données précédemment uploadé -->
                                    <div class="tab-pane fade" id="my-uploaded-layers" role="tabpanel" aria-labelledby="my-uploaded-layers-tab">
                                        <ul id="my_imported_layer_list"></ul>
                                    </div>
                                </div>
                            </div>

                            <div id="add-drawing-layer" class="modal-div-content">
                                <form id="form-upload-layer" enctype="multipart/form-data">
                                    <div class="row mt-3 mb-2">
                                        <div class="col-12 p-2 border">
                                            <p class="m-0 text-warning"><b>Attention !</b> une couche de dessin est une couche temporaire permettant d'afficher des informations complémentaires sur la carte.</b></p>
                                            <p class="m-0 text-warning text-center"><b>Ces données ne seront pas sauvegardées et seront perdues à la fermeture de la page !</b></p>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <!-- Bloc de gauche -->
                                        <div class="col-lg-6 border-end">
                                            <!-- Champ nom de la données -->
                                            <div class="form-group">
                                                <label for="form-upload-layer-data-name" class="form-label fw-bold mb-0 mt-2">Nom de la couche de donnée *</label>
                                                <input type="text" class="form-control" id="form-drawing-layer-name" placeholder="Nom">
                                            </div>
                                        </div>
                                    </div>
                                </form>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="add-layer-submit" type="submit" class="btn btn-primary">
                        <div id="loading-spinner" class="spinner-grow spinner-grow-sm" role="status"></div>
                        Ajouter la couche
                    </button>
                    <button id="add-layer-cancel" type="button" class="btn btn-warning" data-bs-dismiss="modal">Annuler</button>
                    <!--<div id="form-login-error" class="invalid-feedback"></div>-->
                </div>
            <!--</form>-->
        </div>
    </div>
</div>